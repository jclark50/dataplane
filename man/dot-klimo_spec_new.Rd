% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dp_write_parquet.R
\name{.klimo_spec_new}
\alias{.klimo_spec_new}
\title{Create a Klimo field specification object (S3)}
\usage{
.klimo_spec_new(
  spec_dt,
  declared_system = c("metric", "imperial", "custom"),
  version = "1",
  system = NULL,
  ...
)
}
\arguments{
\item{spec_dt}{data.table/data.frame describing the spec.}

\item{declared_system}{"metric" or "imperial".}

\item{version}{version string stored in metadata.}
}
\value{
klimo_spec object
}
\description{
A `klimo_spec` stores a per-column specification table (as a `data.table`)
plus a declared unit system (`"metric"` or `"imperial"`). The spec is used by
`dp_write_parquet()` to:
  - determine declared units per column,
  - optionally validate/convert values to match declared units,
  - optionally create scaled integer columns (writer scaling),
  - describe already-encoded columns (e.g., lat_idx_10) without re-scaling,
  - write spec + audit metadata into Parquet schema key_value_metadata.
}
\details{
Required column:
- column

Recommended columns:
- concept
- metric_units, imperial_units (if you want both systems available)
- declared_units (optional; if present, used directly)

Scaling / encoding:
- writer_scale: numeric multiplier used to create a new integer column at write time
- encoding: "none" or "scaled_int"
- encoding_scale: numeric scale used in storage (e.g., 10 means value_on_disk = true_value * 10)
- encoding_base_units: units of the decoded quantity (e.g., "deg")
}
\keyword{internal}
